<!DOCTYPE html>

<html :class="{'dark': darkMode === 'dark' || (darkMode === 'system' &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)}" class="scroll-smooth" data-content_root="../../../" lang="en" x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }" x-init="$watch('darkMode', val =&gt; localStorage.setItem('darkMode', val))">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="white" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="black" media="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="https://fg-research.com/_static/thumbnail.png" name="thumbnail"/>
<meta content="Forecasting US inflation with random forests" name="description"/>
<meta content="Time Series, Forecasting, Machine Learning, Macroeconomics, Inflation" name="keywords"/>

<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-2L0F07XRQM"></script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-2L0F07XRQM');
    </script>
<script type="text/javascript">
    var _iub = _iub || [];
    _iub.csConfiguration = {"floatingPreferencesButtonDisplay": false, "askConsentAtCookiePolicyUpdate":true,"countryDetection":true,"emailMarketing":{"styles":{"backgroundColor":"#FFFFFF","buttonsBackgroundColor":"#D3D4D5","buttonsTextColor":"#0F172A","footerBackgroundColor":"#64748B","footerTextColor":"#FFFFFF","textColor":"#0F172A"}},"enableFadp":true,"enableLgpd":true,"enableUspr":true,"lang":"en","lgpdAppliesGlobally":false,"logViaAlert":true,"perPurposeConsent":true,"preferenceCookie":{"expireAfter":180},"siteId":3844372,"storage":{"useSiteId":true},"cookiePolicyId":49690203,"i18n":{"en":{"banner":{"dynamic":{"body":"fg-research.com and selected third parties use cookies or similar technologies for technical purposes and, with your consent, for functionality, experience, measurement and marketing (personalized ads). Use the “Accept” button to consent. Use the “Reject” button to continue without accepting."}}}},"banner":{"acceptButtonCaptionColor":"#0F172A","acceptButtonColor":"#D3D4D5","acceptButtonDisplay":true,"backgroundColor":"#FFFFFF","closeButtonDisplay":false,"customizeButtonColor":"#64748B","customizeButtonDisplay":true,"explicitWithdrawal":true,"fontSizeBody":"12px","listPurposes":true,"linksColor":"#0F172A","ownerName":"fg-research.com","position":"float-bottom-center","rejectButtonCaptionColor":"#0F172A","rejectButtonColor":"#D3D4D5","rejectButtonDisplay":true,"showPurposesToggles":false,"showTitle":false,"showTotalNumberOfProviders":true,"slideDown":false,"textColor":"#0F172A","acceptButtonCaption":"Accept","customizeButtonCaption":"Learn more","rejectButtonCaption":"Reject"}};
    </script>
<script src="https://cs.iubenda.com/autoblocking/3844372.js" type="text/javascript"></script>
<script src="//cdn.iubenda.com/cs/gpp/stub.js" type="text/javascript"></script>
<script async="" charset="UTF-8" src="//cdn.iubenda.com/cs/iubenda_cs.js" type="text/javascript"></script>
<title>Forecasting US inflation with random forests | fg-research</title>
<meta content="Forecasting US inflation with random forests | fg-research" property="og:title"/>
<meta content="Forecasting US inflation with random forests | fg-research" name="twitter:title"/>
<link href="../../../_static/pygments.css?v=8d216cef" rel="stylesheet" type="text/css"/>
<link href="../../../_static/theme.css?v=ecdfb4fc" rel="stylesheet" type="text/css"/>
<link href="../../../_static/sphinx-design.min.css?v=87e54e7c" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css?v=fcb96942" rel="stylesheet" type="text/css"/>
<link href="../../../_static/awesome-sphinx-design.css?v=a54cf077" rel="stylesheet" type="text/css"/>
<link href="https://fg-research.com/blog/general/posts/inflation-forecasting-random-forest.html" rel="canonical"/>
<link href="../../../_static/favicon.ico" rel="icon"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="fred-md-overview.html" rel="next" title="An overview of the FRED-MD database"/>
<link href="commodity-forecasting-forgan.html" rel="prev" title="Forecasting commodity prices with generative adversarial networks"/>
<script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="../../../index.html">
<img alt="Logo" class="mr-2 dark:invert" height="24" src="../../../_static/logo.png" width="24"/><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">fg-research</span>
</a></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none"><form @keydown.k.window.meta="$refs.search.focus()" action="../../../search.html" class="relative flex items-center group" id="searchbox" method="get">
<input aria-label="Search the docs" class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" id="search-input" name="q" placeholder="Search ..." type="search" x-ref="search"/>
<kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
<span class="text-xs">⌘</span>
    K
  </kbd>
</form>
</div>
<nav class="flex items-center space-x-1">
<a href="https://github.com/fg-research" rel="noopener nofollow" title="Visit GitHub">
<div class="inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md disabled:opacity-50 disabled:pointer-events-none hover:bg-accent hover:text-accent-foreground h-9 w-9">
<svg fill="currentColor" height="26px" style="margin-top:-2px;display:inline" viewbox="0 0 45 44" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M22.477.927C10.485.927.76 10.65.76 22.647c0 9.596 6.223 17.736 14.853 20.608 1.087.2 1.483-.47 1.483-1.047 0-.516-.019-1.881-.03-3.693-6.04 1.312-7.315-2.912-7.315-2.912-.988-2.51-2.412-3.178-2.412-3.178-1.972-1.346.149-1.32.149-1.32 2.18.154 3.327 2.24 3.327 2.24 1.937 3.318 5.084 2.36 6.321 1.803.197-1.403.759-2.36 1.379-2.903-4.823-.548-9.894-2.412-9.894-10.734 0-2.37.847-4.31 2.236-5.828-.224-.55-.969-2.759.214-5.748 0 0 1.822-.584 5.972 2.226 1.732-.482 3.59-.722 5.437-.732 1.845.01 3.703.25 5.437.732 4.147-2.81 5.967-2.226 5.967-2.226 1.185 2.99.44 5.198.217 5.748 1.392 1.517 2.232 3.457 2.232 5.828 0 8.344-5.078 10.18-9.916 10.717.779.67 1.474 1.996 1.474 4.021 0 2.904-.027 5.247-.027 5.96 0 .58.392 1.256 1.493 1.044C37.981 40.375 44.2 32.24 44.2 22.647c0-11.996-9.726-21.72-21.722-21.72" fill="currentColor" fill-rule="evenodd"></path></svg>
</div>
</a>
<button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'" aria-label="Color theme switcher" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="!justify-start text-sm md:!hidden bg-background" href="../../../index.html">
<img alt="Logo" class="mr-2 dark:invert" height="16" src="../../../_static/logo.png" width="16"/><span class="font-bold text-clip whitespace-nowrap">fg-research</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
<div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
<p class="caption" role="heading"><span class="caption-text">Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-forecasting/index.html">Time Series Forecasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-anomaly-detection/index.html">Time Series Anomaly Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-classification/index.html">Time Series Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-clustering/index.html">Time Series Clustering</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Blog</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../product/index.html">Product</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">General</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Terms and Conditions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../terms/disclaimer/index.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../terms/eula/index.html">EULA</a></li>
</ul>
</nav>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="../../../index.html">
<span class="hidden md:inline">fg-research</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">/</div><a class="hover:text-foreground overflow-hidden text-ellipsis whitespace-nowrap" href="../index.html">General</a>
<div class="mr-1">/</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">Forecasting US inflation with random forests</span>
</nav>
<div id="content" role="main">
<section id="forecasting-us-inflation-with-random-forests">
<h1>Forecasting US inflation with random forests<a class="headerlink" href="#forecasting-us-inflation-with-random-forests" title="Link to this heading">¶</a></h1>
<p>
Inflation forecasts are used for informing economic decisions at various levels,
from households to businesses and policymakers. The application of machine learning
methods to inflation forecasting offers several potential advantages, including
the ability to handle large and complex datasets, capture nonlinear relationships,
and adapt to changing economic conditions.
</p>
<p>
Several recent papers have studied the performance of machine learning models
for forecasting US inflation using the <a href="https://research.stlouisfed.org/econ/mccracken/fred-databases/" target="_blank">
FRED-MD</a> dataset <a href="#references">[1]</a>. The FRED-MD dataset includes
over 100 monthly time series belonging to 8 different groups of US macroeconomic
indicators: output and income, labour market, consumption and orders, orders and
inventory, money and credit, interest rates and exchange rates, prices, and stock
market. For a detailed overview of the FRED-MD dataset, we refer to
<a href="https://fg-research.com/blog/general/posts/fred-md-overview.html" target="_blank">our previous post</a>.
</p>
<p>
In this post, we will focus on the random forest model introduced in <a href="#references">[2]</a>,
which was found to outperform both standard univariate forecasting models such as the autoregressive (AR) model
and several other machine learning methods including Lasso, Ridge and Elastic Net regressions.
We will use the random forest model for forecasting the US CPI monthly inflation, which we
define as the month-over-month logarithmic change in the US CPI index as in <a href="#references">[2]</a>.
</p>
<p>
For simplicity, we will consider only one-month-ahead forecasts. We will use the random
forest model for predicting next month's inflation based on the past values
of all FRED-MD indicators, including the past inflation. We will evaluate the model using
an expanding window approach: on each month we will train the model using all the available
data up to that month, and generate the forecast for next month. We use the data
from January 2015 to January 2024 for our analysis. Our findings indicate that,
over the considered time period, the random forest model outperforms the AR model
under different measures of forecast error.
</p><section id="model">
<h2>Model<a class="headerlink" href="#model" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#model'">¶</a></h2>
<p>
A random forest is an ensemble of decision trees. A decision tree approximates the
relationship between the target and the features by splitting the feature space
into different subsets, and generating a constant prediction for each subset.
In the regression case, which is the one relevant to this post, the constant
prediction is the average of the target values in the subset.
A decision tree can be seen as a nonparametric regression model,
where the regression function that links the target to the features is estimated
using a piecewise constant approximation.
</p>
<p>
The partition of the feature space is determined in a recursive manner during the
process of growing the tree. At the beginning of this process, the tree
contains only one node, referred to as root note, which includes the full
dataset. In the root node, the target is predicted with the average of all target observations in the dataset.
After that, the dataset is recursively split into smaller and smaller subsets
referred to as nodes, where each newly created node (child) is a subsample
of a previously existing node (parent). At each node, the target is predicted with
the average of the target observations in that node.
</p>
<p>
The splits used for creating the nodes are determined through an optimization process
which minimizes a given loss function under a number of constraints, such as
that each node should contain a minimum number of samples.
A common loss function is the mean squared error of the node's prediction,
which is equal to the variance of the target values in the node, and which therefore
tends to result in nodes containing similar target values.
</p>
<p>
As the tree grows, finer and finer partitions of the feature space are created,
reducing the error of the predictions. This process continues until a
pre-specified condition is met, such as that all terminal nodes, referred to as
leaves, contain at least a minimum number of observations, or that the depth of
the tree, as determined by the number of nodes or recursive splits
from the root node to the leaves, has reached a maximum value.
</p>
<p>
Decision trees are prone to overfitting. A deep enough tree can potentially isolate
each target value in one leaf, in which case the model predictions exactly match
the target values observed during training, but are unlikely to provide a good
approximation for new unseen data that was not used for training. Decision trees
are also not very robust to the input data, as small changes in the training data
can potentially result in completely different tree structures.
</p>
<p>
Random forests address these limitations by creating an ensemble of decision trees
which are trained on different random subsets of the training data (sample bagging) using
different random subsets of features (feature bagging). The random forest predictions
are then obtained by averaging the individual predictions of the trees in the ensemble.
The mechanisms of sample bagging and feature bagging reduce the correlation between
the predictions of the different trees, making the overall ensemble more robust
and less prone to overfitting <a href="#references">[3]</a>.
</p>
<img alt="Schematic representation of random forest algorithm" class="blog-post-image" id="inflation-forecasting-random-forest-diagram" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/diagram_light.png" style="width:80%"/>
<p class="blog-post-image-caption">Schematic representation of random forest algorithm, adapted from
<a href="#references">[4]</a>.</p></section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#data'">¶</a></h2>
<p>
As discussed in <a href="https://fg-research.com/blog/general/posts/fred-md-overview.html" target="_blank">our previous post</a>, FRED-MD is a large, open-source, dataset
of monthly U.S. macroeconomic indicators maintained by the Federal Reserve Bank of St. Louis.
The FRED-MD dataset is updated on a monthly basis.
The monthly releases are referred to as vintages. Each vintage includes the data
from January 1959 up to the previous month. For instance, the 02-2024 vintage contains
the data from January 1959 to January 2024.
</p>
<p>
The vintages are subject to retrospective adjustments, such as seasonal adjustments,
inflation adjustments and backfilling of missing values. For this reason, different
vintages can potentially report different values for the same time series on the
same date. Furthermore, different vintages can include different time series, as
indicators are occasionally added and removed from the dataset.
</p>
<p>
We use all vintages from 2025-01 to 2024-02 for our analysis, which is a
real-time forecasting exercise. On each month, we train the model using
the data in the vintage released on that month, and generate the forecast
for the next month. We then compare the forecast to the data in the vintage
released on the subsequent month.
</p>
<p>
As in <a href="#references">[2]</a>, we include among the features the first 4 principal
components, which are estimated on all the time series, and the first 4 lags
of all the time series, including the lags of the principal components and
the lags of the target time series. This results in approximately 500 features,
even though the exact number of features changes over time,
depending on how many time series are included in each vintage.
</p>
<img alt="US CPI index and corresponding month-over-month logarithmic change" class="blog-post-image" id="inflation-forecasting-random-forest-time-series" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/time_series_light.png" style="width:80%"/>
<p class="blog-post-image-caption">US CPI index (FRED: CPIAUCSL) and corresponding month-over-month
logarithmic change. Source: FRED-MD dataset, 02-2024 vintage.</p></section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#code'">¶</a></h2>
<p>We start by importing the dependencies.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="line-2"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="line-3"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="line-4"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="line-5"><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</span><span id="line-6"><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</span><span id="line-7"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</span><span id="line-8"><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</span><span id="line-9"><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
</span><span id="line-10"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">root_mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</span><span id="line-11"><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">median_abs_deviation</span>
</span></code></pre></div>
</div>
<p>
After that, we define a number of auxiliary functions for downloading and processing the FRED-MD dataset.
As discussed in <a href="https://fg-research.com/blog/general/posts/fred-md-overview.html" target="_blank">
our previous post</a>, the FRED-MD dataset includes a set of transformations to be applied to the time
series in order to ensure their stationarity, which are implemented in the function below.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">def</span> <span class="nf">transform_series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tcode</span><span class="p">):</span>
</span><span id="line-2"><span class="w">    </span><span class="sd">'''</span>
</span><span id="line-3"><span class="sd">    Transform the time series.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">    Parameters:</span>
</span><span id="line-6"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-7"><span class="sd">    x: pandas.Series</span>
</span><span id="line-8"><span class="sd">        Time series.</span>
</span><span id="line-9">
</span><span id="line-10"><span class="sd">    tcode: int.</span>
</span><span id="line-11"><span class="sd">        Transformation code.</span>
</span><span id="line-12"><span class="sd">    '''</span>
</span><span id="line-13">
</span><span id="line-14">    <span class="k">if</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="line-15">        <span class="c1"># no transformation</span>
</span><span id="line-16">        <span class="k">return</span> <span class="n">x</span>
</span><span id="line-17">
</span><span id="line-18">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="line-19">        <span class="c1"># first order absolute difference</span>
</span><span id="line-20">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-21">
</span><span id="line-22">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="line-23">        <span class="c1"># second order absolute difference</span>
</span><span id="line-24">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-25">
</span><span id="line-26">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="line-27">        <span class="c1"># logarithm</span>
</span><span id="line-28">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="line-29">
</span><span id="line-30">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="line-31">        <span class="c1"># first order logarithmic difference</span>
</span><span id="line-32">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-33">
</span><span id="line-34">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="line-35">        <span class="c1"># second order logarithmic difference</span>
</span><span id="line-36">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-37">
</span><span id="line-38">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
</span><span id="line-39">        <span class="c1"># first order relative difference</span>
</span><span id="line-40">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</span><span id="line-41">
</span><span id="line-42">    <span class="k">else</span><span class="p">:</span>
</span><span id="line-43">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"unknown `tcode` </span><span class="si">{</span><span class="n">tcode</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<p>
We then define a function for downloading and processing the data.
In this function, we download the FRED-MD dataset for the considered vintage,
transform the time series using the provided transformation codes (with the
exception of the target time series, for which we use the first order
logarithmic difference), derive the principal components, and take the
lags of all the time series. As in <a href="#references">[2]</a>,
we use the data after January 1960, and we only use the time
series without missing values.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_tcode</span><span class="p">,</span> <span class="n">n_lags</span><span class="p">,</span> <span class="n">n_components</span><span class="p">):</span>
</span><span id="line-2"><span class="w">    </span><span class="sd">'''</span>
</span><span id="line-3"><span class="sd">    Download and process the data.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">    Parameters:</span>
</span><span id="line-6"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-7"><span class="sd">    date: pandas.Timestamp.</span>
</span><span id="line-8"><span class="sd">        The date of the dataset vintage.</span>
</span><span id="line-9">
</span><span id="line-10"><span class="sd">    target_name: string.</span>
</span><span id="line-11"><span class="sd">        The name of the target time series.</span>
</span><span id="line-12">
</span><span id="line-13"><span class="sd">    target_tcode: int.</span>
</span><span id="line-14"><span class="sd">        The transformation code of the target time series.</span>
</span><span id="line-15">
</span><span id="line-16"><span class="sd">    n_lags: int.</span>
</span><span id="line-17"><span class="sd">        The number of autoregressive lags.</span>
</span><span id="line-18">
</span><span id="line-19"><span class="sd">    n_components: int.</span>
</span><span id="line-20"><span class="sd">        The number of principal components.</span>
</span><span id="line-21">
</span><span id="line-22"><span class="sd">    Returns:</span>
</span><span id="line-23"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-24"><span class="sd">    train_data: pandas.DataFrame.</span>
</span><span id="line-25"><span class="sd">        The training dataset.</span>
</span><span id="line-26">
</span><span id="line-27"><span class="sd">    test_data: pandas.DataFrame.</span>
</span><span id="line-28"><span class="sd">        The inputs to the one-month-ahead forecasts.</span>
</span><span id="line-29"><span class="sd">    '''</span>
</span><span id="line-30">
</span><span id="line-31">    <span class="c1"># get the dataset URL</span>
</span><span id="line-32">    <span class="n">file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"https://files.stlouisfed.org/files/htdocs/fred-md/monthly/</span><span class="si">{</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="s1">'02d'</span><span class="p">)</span><span class="si">}</span><span class="s2">.csv"</span>
</span><span id="line-33">
</span><span id="line-34">    <span class="c1"># get the time series</span>
</span><span id="line-35">    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="line-36">    <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</span><span id="line-37">
</span><span id="line-38">    <span class="c1"># process the dates</span>
</span><span id="line-39">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="p">:]</span>
</span><span id="line-40">    <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">"1959-01-01"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="line-41">
</span><span id="line-42">    <span class="c1"># get the transformation codes</span>
</span><span id="line-43">    <span class="n">tcodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="line-44">    <span class="n">tcodes</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tcodes</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</span><span id="line-45">
</span><span id="line-46">    <span class="c1"># override the target's transformation code</span>
</span><span id="line-47">    <span class="n">tcodes</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_tcode</span>
</span><span id="line-48">
</span><span id="line-49">    <span class="c1"># transform the time series</span>
</span><span id="line-50">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">transform_series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tcodes</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
</span><span id="line-51">
</span><span id="line-52">    <span class="c1"># select the data after January 1960</span>
</span><span id="line-53">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">"1960-01-01"</span><span class="p">)]</span>
</span><span id="line-54">
</span><span id="line-55">    <span class="c1"># drop the incomplete time series</span>
</span><span id="line-56">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="line-57">
</span><span id="line-58">    <span class="c1"># add the principal components</span>
</span><span id="line-59">    <span class="n">pca</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">"scaling"</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">"decomposition"</span><span class="p">,</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">))])</span>
</span><span id="line-60">    <span class="n">data</span><span class="p">[[</span><span class="sa">f</span><span class="s2">"PC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_components</span><span class="p">)]]</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="line-61">
</span><span id="line-62">    <span class="c1"># extract the training data; this includes the target time series and the lags of</span>
</span><span id="line-63">    <span class="c1"># all time series; the missing values resulting from taking the lags are dropped</span>
</span><span id="line-64">    <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">target_name</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_lags</span><span class="p">)),</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">"_LAG"</span><span class="p">))</span>
</span><span id="line-65">    <span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">n_lags</span><span class="p">:,</span> <span class="p">:]</span>
</span><span id="line-66">
</span><span id="line-67">    <span class="c1"># extract the test data; this includes the last `n_lags` values (e.g. the last 4</span>
</span><span id="line-68">    <span class="c1"># values) of all time series; the time index is shifted forward by one month to</span>
</span><span id="line-69">    <span class="c1"># match the date for which the forecasts are generated</span>
</span><span id="line-70">    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_lags</span><span class="p">)),</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">"_LAG"</span><span class="p">)</span>
</span><span id="line-71">    <span class="n">test_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
</span><span id="line-72">    <span class="n">test_data</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthBegin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="line-73">    <span class="n">test_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"_LAG_"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"_LAG_"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"_LAG_"</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">test_data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</span><span id="line-74">
</span><span id="line-75">    <span class="k">return</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span>
</span></code></pre></div>
</div>
<p>
We also define a function for downloading and processing the target time series.
We will use this function for obtaining the realized target values against
which we will compare the forecasts.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">def</span> <span class="nf">get_target</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_tcode</span><span class="p">):</span>
</span><span id="line-2"><span class="w">    </span><span class="sd">'''</span>
</span><span id="line-3"><span class="sd">    Extract the target time series from a range of dataset vintages.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">    Parameters:</span>
</span><span id="line-6"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-7"><span class="sd">    start_date: pandas.Timestamp.</span>
</span><span id="line-8"><span class="sd">        The date of the first vintage.</span>
</span><span id="line-9">
</span><span id="line-10"><span class="sd">    end_date: pandas.Timestamp.</span>
</span><span id="line-11"><span class="sd">        The date of the last vintage.</span>
</span><span id="line-12">
</span><span id="line-13"><span class="sd">    target_name: str.</span>
</span><span id="line-14"><span class="sd">        The name of the target time series.</span>
</span><span id="line-15">
</span><span id="line-16"><span class="sd">    target_tcode: int.</span>
</span><span id="line-17"><span class="sd">        The transformation code of the target time series.</span>
</span><span id="line-18">
</span><span id="line-19"><span class="sd">    Returns:</span>
</span><span id="line-20"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-21"><span class="sd">    targets: pandas.DataFrame.</span>
</span><span id="line-22"><span class="sd">        The target time series between the start and end date.</span>
</span><span id="line-23"><span class="sd">    '''</span>
</span><span id="line-24">
</span><span id="line-25">    <span class="c1"># create a list for storing the target values</span>
</span><span id="line-26">    <span class="n">targets</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-27">
</span><span id="line-28">    <span class="c1"># loop across the dataset vintages</span>
</span><span id="line-29">    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">)):</span>
</span><span id="line-30">
</span><span id="line-31">        <span class="c1"># get the dataset URL</span>
</span><span id="line-32">        <span class="n">file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"https://files.stlouisfed.org/files/htdocs/fred-md/monthly/</span><span class="si">{</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="s1">'02d'</span><span class="p">)</span><span class="si">}</span><span class="s2">.csv"</span>
</span><span id="line-33">
</span><span id="line-34">        <span class="c1"># get the time series</span>
</span><span id="line-35">        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="line-36">        <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</span><span id="line-37">
</span><span id="line-38">        <span class="c1"># process the dates</span>
</span><span id="line-39">        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="p">:]</span>
</span><span id="line-40">        <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">"1959-01-01"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</span><span id="line-41">
</span><span id="line-42">        <span class="c1"># select the target time series</span>
</span><span id="line-43">        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">target_name</span><span class="p">]]</span>
</span><span id="line-44">
</span><span id="line-45">        <span class="c1"># transform the target time series</span>
</span><span id="line-46">        <span class="n">data</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">target_name</span><span class="p">],</span> <span class="n">target_tcode</span><span class="p">)</span>
</span><span id="line-47">
</span><span id="line-48">        <span class="c1"># select the last value</span>
</span><span id="line-49">        <span class="n">targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="line-50">
</span><span id="line-51">    <span class="c1"># concatenate the target values in a data frame</span>
</span><span id="line-52">    <span class="n">targets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="line-53">
</span><span id="line-54">    <span class="k">return</span> <span class="n">targets</span>
</span></code></pre></div>
</div>
<p>
Finally, we define a function for training the random forest model
and generating the one-month-ahead forecasts.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">def</span> <span class="nf">run_random_forest_model</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">target_name</span><span class="p">):</span>
</span><span id="line-2"><span class="w">    </span><span class="sd">'''</span>
</span><span id="line-3"><span class="sd">    Run the random forest model.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">    Parameters:</span>
</span><span id="line-6"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-7"><span class="sd">    params: dict.</span>
</span><span id="line-8"><span class="sd">        The random forest hyperparameters.</span>
</span><span id="line-9">
</span><span id="line-10"><span class="sd">    train_data: pandas.DataFrame.</span>
</span><span id="line-11"><span class="sd">        The training dataset.</span>
</span><span id="line-12">
</span><span id="line-13"><span class="sd">    test_data: pandas.DataFrame.</span>
</span><span id="line-14"><span class="sd">        The inputs to the one-month-ahead forecasts.</span>
</span><span id="line-15">
</span><span id="line-16"><span class="sd">    target_name: str.</span>
</span><span id="line-17"><span class="sd">        The name of the target time series.</span>
</span><span id="line-18">
</span><span id="line-19"><span class="sd">    Returns:</span>
</span><span id="line-20"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-21"><span class="sd">    forecasts: pandas.Series.</span>
</span><span id="line-22"><span class="sd">        The one-month-ahead forecasts.</span>
</span><span id="line-23"><span class="sd">    '''</span>
</span><span id="line-24">
</span><span id="line-25">    <span class="c1"># instantiate the model</span>
</span><span id="line-26">    <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span id="line-27">
</span><span id="line-28">    <span class="c1"># fit the model</span>
</span><span id="line-29">    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="line-30">        <span class="n">X</span><span class="o">=</span><span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">target_name</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span><span id="line-31">        <span class="n">y</span><span class="o">=</span><span class="n">train_data</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span>
</span><span id="line-32">    <span class="p">)</span>
</span><span id="line-33">
</span><span id="line-34">    <span class="c1"># generate the forecasts</span>
</span><span id="line-35">    <span class="n">forecasts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
</span><span id="line-36">        <span class="n">data</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">test_data</span><span class="p">),</span>
</span><span id="line-37">        <span class="n">index</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span>
</span><span id="line-38">    <span class="p">)</span>
</span><span id="line-39">
</span><span id="line-40">    <span class="k">return</span> <span class="n">forecasts</span>
</span></code></pre></div>
</div>
<p>
We define a similar function for the AR model, which we will use as a benchmark.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">def</span> <span class="nf">run_autoregressive_model</span><span class="p">(</span><span class="n">n_lags</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">target_name</span><span class="p">):</span>
</span><span id="line-2"><span class="w">    </span><span class="sd">'''</span>
</span><span id="line-3"><span class="sd">    Run the autoregressive model.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">    Parameters:</span>
</span><span id="line-6"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-7"><span class="sd">    n_lags: int.</span>
</span><span id="line-8"><span class="sd">        The number of autoregressive lags.</span>
</span><span id="line-9">
</span><span id="line-10"><span class="sd">    train_data: pandas.DataFrame.</span>
</span><span id="line-11"><span class="sd">        The training dataset.</span>
</span><span id="line-12">
</span><span id="line-13"><span class="sd">    test_data: pandas.DataFrame.</span>
</span><span id="line-14"><span class="sd">        The inputs to the one-month-ahead forecasts.</span>
</span><span id="line-15">
</span><span id="line-16"><span class="sd">    target_name: str.</span>
</span><span id="line-17"><span class="sd">        The name of the target time series.</span>
</span><span id="line-18">
</span><span id="line-19"><span class="sd">    Returns:</span>
</span><span id="line-20"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-21"><span class="sd">    forecasts: pandas.Series.</span>
</span><span id="line-22"><span class="sd">        The one-month-ahead forecasts.</span>
</span><span id="line-23"><span class="sd">    '''</span>
</span><span id="line-24">
</span><span id="line-25">    <span class="c1"># instantiate the model</span>
</span><span id="line-26">    <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="line-27">
</span><span id="line-28">    <span class="c1"># fit the model</span>
</span><span id="line-29">    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="line-30">        <span class="n">X</span><span class="o">=</span><span class="n">train_data</span><span class="p">[[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">target_name</span><span class="si">}</span><span class="s2">_LAG_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]],</span>
</span><span id="line-31">        <span class="n">y</span><span class="o">=</span><span class="n">train_data</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span>
</span><span id="line-32">    <span class="p">)</span>
</span><span id="line-33">
</span><span id="line-34">    <span class="c1"># generate the forecasts</span>
</span><span id="line-35">    <span class="n">forecasts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
</span><span id="line-36">        <span class="n">data</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">test_data</span><span class="p">[[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">target_name</span><span class="si">}</span><span class="s2">_LAG_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]]),</span>
</span><span id="line-37">        <span class="n">index</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span>
</span><span id="line-38">    <span class="p">)</span>
</span><span id="line-39">
</span><span id="line-40">    <span class="k">return</span> <span class="n">forecasts</span>
</span></code></pre></div>
</div>
<p>
Lastly, we define a function for iterating over the dataset vintages,
downloading and processing the data, fitting the random forest and AR models to the data,
and generating the one-month-ahead forecasts. For comparison purposes, we also include
the random walk (RW) model, which always predicts that next month's inflation will
be the same as the current month's inflation.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">def</span> <span class="nf">get_forecasts</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_tcode</span><span class="p">,</span> <span class="n">n_lags</span><span class="p">,</span> <span class="n">n_components</span><span class="p">):</span>
</span><span id="line-2"><span class="w">    </span><span class="sd">'''</span>
</span><span id="line-3"><span class="sd">    Generate the forecasts over a range of dataset vintages.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">    Parameters:</span>
</span><span id="line-6"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-7"><span class="sd">    params: dict.</span>
</span><span id="line-8"><span class="sd">        The random forest hyperparameters.</span>
</span><span id="line-9">
</span><span id="line-10"><span class="sd">    start_date: pandas.Timestamp.</span>
</span><span id="line-11"><span class="sd">        The date of the first vintage.</span>
</span><span id="line-12">
</span><span id="line-13"><span class="sd">    end_date: pandas.Timestamp.</span>
</span><span id="line-14"><span class="sd">        The date of the last vintage.</span>
</span><span id="line-15">
</span><span id="line-16"><span class="sd">    target_name: str.</span>
</span><span id="line-17"><span class="sd">        The name of the target time series.</span>
</span><span id="line-18">
</span><span id="line-19"><span class="sd">    target_tcode: int.</span>
</span><span id="line-20"><span class="sd">        The transformation code of the target time series.</span>
</span><span id="line-21">
</span><span id="line-22"><span class="sd">    n_lags: int.</span>
</span><span id="line-23"><span class="sd">        The number of autoregressive lags.</span>
</span><span id="line-24">
</span><span id="line-25"><span class="sd">    n_components: int.</span>
</span><span id="line-26"><span class="sd">        The number of principal components.</span>
</span><span id="line-27">
</span><span id="line-28"><span class="sd">    Returns:</span>
</span><span id="line-29"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-30"><span class="sd">    forecasts: pandas.DataFrame.</span>
</span><span id="line-31"><span class="sd">        The forecasts between the start and end date.</span>
</span><span id="line-32"><span class="sd">    '''</span>
</span><span id="line-33">
</span><span id="line-34">    <span class="c1"># create a list for storing the forecasts</span>
</span><span id="line-35">    <span class="n">forecasts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-36">
</span><span id="line-37">    <span class="c1"># loop across the dataset vintages</span>
</span><span id="line-38">    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">)):</span>
</span><span id="line-39">
</span><span id="line-40">        <span class="c1"># get the data</span>
</span><span id="line-41">        <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_tcode</span><span class="p">,</span> <span class="n">n_lags</span><span class="p">,</span> <span class="n">n_components</span><span class="p">)</span>
</span><span id="line-42">
</span><span id="line-43">        <span class="c1"># generate the forecasts</span>
</span><span id="line-44">        <span class="n">forecasts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="line-45">            <span class="s2">"RF"</span><span class="p">:</span> <span class="n">run_random_forest_model</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">target_name</span><span class="p">),</span>
</span><span id="line-46">            <span class="s2">"AR"</span><span class="p">:</span> <span class="n">run_autoregressive_model</span><span class="p">(</span><span class="n">n_lags</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">target_name</span><span class="p">),</span>
</span><span id="line-47">            <span class="s2">"RW"</span><span class="p">:</span> <span class="n">train_data</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="line-48">        <span class="p">}))</span>
</span><span id="line-49">
</span><span id="line-50">    <span class="c1"># concatenate the forecasts in a data frame</span>
</span><span id="line-51">    <span class="n">forecasts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">forecasts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="line-52">
</span><span id="line-53">    <span class="k">return</span> <span class="n">forecasts</span>
</span></code></pre></div>
</div>
<p>
We are now ready to run the analysis.
We start by defining the target name, which is the FRED name of the US CPI index (CPIAUCSL),
the target transformation code, which is 5 for first order logarithmic difference, and the dates
of the first and last vintages used for the analysis.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">target_name</span> <span class="o">=</span> <span class="s2">"CPIAUCSL"</span>
</span><span id="line-2"><span class="n">target_tcode</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="line-3"><span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">"2015-01-01"</span><span class="p">)</span>
</span><span id="line-4"><span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">"2024-01-01"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<p>
After that, we generate the one-month-ahead forecasts over the considered time window.
For the random forest model, we set the number of trees in the ensemble equal to 500, the maximum fraction of
randomly selected features equal to 1 / 3, and the minimum number of samples in a
terminal node or leaf equal to 5, as in <a href="#references">[2]</a>. For the autoregressive model,
we use the same number of lags used by the random forest model which, as discussed above, is equal to 4.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">forecasts</span> <span class="o">=</span> <span class="n">get_forecasts</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">params</span><span class="o">=</span><span class="p">{</span>
</span><span id="line-3">        <span class="s2">"n_estimators"</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
</span><span id="line-4">        <span class="s2">"max_features"</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="line-5">        <span class="s2">"min_samples_leaf"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span id="line-6">        <span class="s2">"random_state"</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
</span><span id="line-7">        <span class="s2">"n_jobs"</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="line-8">    <span class="p">},</span>
</span><span id="line-9">    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
</span><span id="line-10">    <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
</span><span id="line-11">    <span class="n">target_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
</span><span id="line-12">    <span class="n">target_tcode</span><span class="o">=</span><span class="n">target_tcode</span><span class="p">,</span>
</span><span id="line-13">    <span class="n">n_lags</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="line-14">    <span class="n">n_components</span><span class="o">=</span><span class="mi">4</span>
</span><span id="line-15"><span class="p">)</span>
</span></code></pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">forecasts</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
</div>
<img alt="First 3 values of inflation forecasts" class="blog-post-image" id="inflation-forecasting-random-forest-forecasts-table-head" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/forecasts_table_head_light.png" style="width:80%"/><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">forecasts</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
</div>
<img alt="Last 3 values of inflation forecasts" class="blog-post-image" id="inflation-forecasting-random-forest-forecasts-table-tail" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/forecasts_table_tail_light.png" style="width:80%"/><p>
We now download the realized target values.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">targets</span> <span class="o">=</span> <span class="n">get_target</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthBegin</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span><span id="line-3">    <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthBegin</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span><span id="line-4">    <span class="n">target_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">target_tcode</span><span class="o">=</span><span class="n">target_tcode</span><span class="p">,</span>
</span><span id="line-6"><span class="p">)</span>
</span></code></pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">targets</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
</div>
<img alt="First 3 values of realized inflation" class="blog-post-image" id="inflation-forecasting-random-forest-targets-table-head" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/targets_table_head_light.png" style="width:80%"/><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">targets</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
</div>
<img alt="Last 3 values of realized inflation" class="blog-post-image" id="inflation-forecasting-random-forest-targets-table-tail" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/targets_table_tail_light.png" style="width:80%"/><p>
Lastly, we calculate the forecast error. We use the root mean squared error (RMSE),
the mean absolute error (MAE) and the median absolute deviation (MAD) as measures
of forecast error.
</p><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">errors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="line-2"><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">forecasts</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="line-3">    <span class="n">errors</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="line-4">            <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">targets</span><span class="p">[</span><span class="n">target_name</span><span class="p">],</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">forecasts</span><span class="p">[</span><span class="n">model</span><span class="p">]),</span>
</span><span id="line-5">            <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">targets</span><span class="p">[</span><span class="n">target_name</span><span class="p">],</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">forecasts</span><span class="p">[</span><span class="n">model</span><span class="p">]),</span>
</span><span id="line-6">            <span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">targets</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span> <span class="o">-</span> <span class="n">forecasts</span><span class="p">[</span><span class="n">model</span><span class="p">])</span>
</span><span id="line-7">        <span class="p">]</span>
</span><span id="line-8"><span class="n">errors</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"RMSE"</span><span class="p">,</span> <span class="s2">"MAE"</span><span class="p">,</span> <span class="s2">"MAD"</span><span class="p">]</span>
</span></code></pre></div>
</div>
<img alt="Forecast errors" class="blog-post-image" id="inflation-forecasting-random-forest-errors-table" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/errors_table_light.png" style="width:80%"/><p>
We find that the random forest model outperforms both the AR model and the RW model
in terms of all considered error metrics.
</p><img alt="Month-over-month logarithmic change in the US CPI index with random forest (RF) and AR(1) forecasts" class="blog-post-image" id="inflation-forecasting-random-forest-forecasts-plot" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/forecasts_plot_light.png" style="width:80%"/>
<p class="blog-post-image-caption">Month-over-month logarithmic change in the US CPI index (FRED: CPIAUCSL)
with random forest (RF) forecasts.</p><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A Python notebook with the full code is available in our <a class="reference external" href="https://github.com/fg-research/blog/tree/master/inflation-forecasting-random-forest">GitHub</a>
repository. The official R code from the authors of <a class="reference external" href="#references">[2]</a> is also available in <a class="reference external" href="https://github.com/gabrielrvsc/ForecastingInflation">GitHub</a>.</p>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#references'">¶</a></h2>
<p>[1] McCracken, M. W., &amp; Ng, S. (2016). FRED-MD: A monthly database for macroeconomic research. <em>Journal of Business &amp; Economic Statistics</em>, 34(4), 574-589. <a class="reference external" href="https://doi.org/10.1080/07350015.2015.1086655">doi: 10.1080/07350015.2015.1086655</a>.</p>
<p>[2] Medeiros, M. C., Vasconcelos, G. F., Veiga, Á., &amp; Zilberman, E. (2021). Forecasting inflation in a data-rich environment: the benefits of machine learning methods. <em>Journal of Business &amp; Economic Statistics</em>, 39(1), 98-119. <a class="reference external" href="https://doi.org/10.1080/07350015.2019.1637745">doi: 10.1080/07350015.2019.1637745</a>.</p>
<p>[3] Breiman, L. (2001). Random forests. <em>Machine learning</em>, 45, 5-32. <a class="reference external" href="https://doi.org/10.1023/A:1010933404324">doi: 10.1023/A:101093340432</a>.</p>
<p>[4] Janosh Riebesell. (2022). janosh/tikz: v0.1.0 (v0.1.0). Zenodo. <a class="reference external" href="https://doi.org/10.5281/zenodo.7486911">doi: 10.5281/zenodo.7486911</a>.</p>
</section>
</section>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(100vh-5rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#model'" class="reference internal" href="#model">Model</a></li>
<li><a :data-current="activeSection === '#data'" class="reference internal" href="#data">Data</a></li>
<li><a :data-current="activeSection === '#code'" class="reference internal" href="#code">Code</a></li>
<li><a :data-current="activeSection === '#references'" class="reference internal" href="#references">References</a></li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© 
2023 fg-research. fg-research is an independent software vendor that provides machine learning solutions on the AWS Marketplace.
Amazon Web Services, AWS, Amazon SageMaker, AWS Marketplace and the AWS Marketplace logo are trademarks of Amazon.com, Inc. or its affiliates.
 Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 7.3.7</a></p>
</div>
</div>
</footer>
</div>
<script src="../../../_static/documentation_options.js?v=953f42dc"></script>
<script src="../../../_static/doctools.js?v=9a2dae69"></script>
<script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
<script defer="defer" src="../../../_static/theme.js?v=e82a16a3"></script>
<script src="../../../_static/design-tabs.js?v=f930bc37"></script>
<script src="../../../_static/custom.js?v=51e3ec04"></script>
</body>
</html>