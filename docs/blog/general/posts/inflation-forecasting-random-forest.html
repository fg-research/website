<!DOCTYPE html>

<html :class="{'dark': darkMode === 'dark' || (darkMode === 'system' &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)}" class="scroll-smooth" lang="en" x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }" x-init="$watch('darkMode', val =&gt; localStorage.setItem('darkMode', val))">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="white" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="black" metia="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator"/>
<meta content="https://fg-research.com/_static/thumbnail.png" name="thumbnail"/>
<meta content="Forecasting US inflation with random forests" name="description"/>
<meta content="Time Series, Forecasting, Machine Learning, Macroeconomics, Inflation" name="keywords"/>
<title>Forecasting US inflation with random forests | fg-research</title>
<meta content="Forecasting US inflation with random forests | fg-research" property="og:title"/>
<meta content="Forecasting US inflation with random forests | fg-research" name="twitter:title"/>
<link href="../../../_static/pygments.css" rel="stylesheet"/>
<link href="../../../_static/theme.47abdafeea10b5ccf58b.css" rel="stylesheet"/>
<link href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" rel="stylesheet"/>
<link href="../../../_static/custom.css" rel="stylesheet"/>
<link href="../../../_static/awesome-sphinx-design.495717882cf46c002fb5.css" rel="stylesheet"/>
<link href="https://fg-research.com/blog/general/posts/inflation-forecasting-random-forest.html" rel="canonical"/>
<link href="../../../_static/favicon.ico" rel="icon"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="../../../genindex.html" rel="index" title="Index"/>
<script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/sphinx_highlight.js"></script>
<script src="../../../_static/design-tabs.js"></script>
<script src="../../../_static/custom.js"></script>
<script defer="" src="../../../_static/theme.4ea23184acb23c5e9294.js"></script>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="../../../index.html"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">fg-research</span>
</a></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none">
<form @keydown.k.window.meta="$refs.search.focus()" action="../../../search.html" class="relative flex items-center group" id="searchbox" method="get">
<input aria-label="Search the docs" class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" id="search-input" name="q" placeholder="Search ..." type="search" x-ref="search"/>
<kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
<span class="text-xs">⌘</span>
      K
    </kbd>
</form>
</div>
<nav class="flex items-center space-x-1">
<a href="https://github.com/fg-research" rel="noopener nofollow" title="Visit GitHub">
<div class="inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md disabled:opacity-50 disabled:pointer-events-none hover:bg-accent hover:text-accent-foreground h-9 w-9">
<svg fill="currentColor" height="26px" style="margin-top:-2px;display:inline" viewbox="0 0 45 44" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M22.477.927C10.485.927.76 10.65.76 22.647c0 9.596 6.223 17.736 14.853 20.608 1.087.2 1.483-.47 1.483-1.047 0-.516-.019-1.881-.03-3.693-6.04 1.312-7.315-2.912-7.315-2.912-.988-2.51-2.412-3.178-2.412-3.178-1.972-1.346.149-1.32.149-1.32 2.18.154 3.327 2.24 3.327 2.24 1.937 3.318 5.084 2.36 6.321 1.803.197-1.403.759-2.36 1.379-2.903-4.823-.548-9.894-2.412-9.894-10.734 0-2.37.847-4.31 2.236-5.828-.224-.55-.969-2.759.214-5.748 0 0 1.822-.584 5.972 2.226 1.732-.482 3.59-.722 5.437-.732 1.845.01 3.703.25 5.437.732 4.147-2.81 5.967-2.226 5.967-2.226 1.185 2.99.44 5.198.217 5.748 1.392 1.517 2.232 3.457 2.232 5.828 0 8.344-5.078 10.18-9.916 10.717.779.67 1.474 1.996 1.474 4.021 0 2.904-.027 5.247-.027 5.96 0 .58.392 1.256 1.493 1.044C37.981 40.375 44.2 32.24 44.2 22.647c0-11.996-9.726-21.72-21.722-21.72" fill="currentColor" fill-rule="evenodd"></path></svg>
</div>
</a>
<button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="!justify-start text-sm md:!hidden bg-background" href="../../../index.html"><span class="font-bold text-clip whitespace-nowrap">fg-research</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
<div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
<p class="caption" role="heading"><span class="caption-text">Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-forecasting/index.html">Time Series Forecasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-anomaly-detection/index.html">Time Series Anomaly Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-clustering/index.html">Time Series Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms/time-series-classification/index.html">Time Series Classification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Blog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../product/index.html">Product</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">General</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Terms and Conditions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../terms/disclaimer/index.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../terms/eula/index.html">EULA</a></li>
</ul>
</nav>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="../../../index.html">
<span class="hidden md:inline">fg-research</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">/</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">Forecasting US inflation with random forests</span>
</nav>
<div id="content" role="main">
<section id="forecasting-us-inflation-with-random-forests">
<h1>Forecasting US inflation with random forests<a class="headerlink" href="#forecasting-us-inflation-with-random-forests" title="Permalink to this heading">¶</a></h1>
<p>
Inflation forecasts are used for informing economic decisions at various levels,
from households to businesses and policymakers. Machine learning approaches offer
several potential advantages for inflation forecasting, including the ability to
handle large and complex datasets, capture nonlinear relationships, and adapt to
changing economic conditions.
</p>
<p>
Several recent papers have studied the performance of machine learning methods
for forecasting US inflation using the <a href="https://research.stlouisfed.org/econ/mccracken/fred-databases/" target="_blank">
FRED-MD</a> dataset <a href="#references">[1]</a>. The FRED-MD dataset includes
over 100 monthly time series belonging to 8 different groups of US macroeconomic
indicators: output and income, labour market, consumption and orders, orders and
inventory, money and credit, interest rates and exchange rates, prices, and stock
market. For a detailed overview of the FRED-MD dataset, we refer to
<a href="https://fg-research.com/blog/general/posts/fred-md-overview.html" target="_blank">our previous post</a>.
</p>
<p>
In this post, we will focus on the random forest model introduced in <a href="#references">[2]</a>,
which was found to outperform both standard univariate forecasting models such as the AR(1) model
and several other machine learning methods including Lasso, Ridge and Elastic Net regressions.
We will use the random forest model for forecasting the US CPI monthly inflation, which we
define as the month-over-month logarithmic change in the US CPI index as in <a href="#references">[2]</a>.
</p>
<p>
For simplicity, we will consider only one-month-ahead forecasts. We will use the random
forest model for predicting next month's inflation based on the current month's values
of all FRED-MD indicators, including the current month's inflation. We will train the
model on the FRED-MD time series up to January 2023, and generate the one-month-ahead
forecasts from February 2023 to January 2024. We find that the random forest model
outperforms the AR(1) model by almost 20% in terms of forecast error.
</p><section id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#model'">¶</a></h2>
<p>
A random forest is an ensemble of decision trees. A decision tree approximates the
relationship between the target and the features by splitting the feature space
into different subsets, and generating a constant prediction for each subset.
Decision trees can be used for both classification and regression. In the regression case,
which is the one relevant to this post, the predicted constant value is the average of the
target values observed for the considered subset of feature values.
</p>
<p>
The partition of the feature space is determined in a recursive manner during the
process of growing the tree. At the beginning of this process, the decision tree
contains only one node, referred to as root note, which includes the full
dataset. The root note predicts the target with the average of all target
observations in the dataset.
</p>
<p>
After that, the dataset is recursively splits into smaller and smaller subsets
referred to as nodes, where each newly created node (child) is a subsample
of a previously existing node (parent). At each node, the target is predicted with
the average of the target observations in that node. The splits used for creating
the nodes are determined through an optimization process which aims to minimize a
given loss function (such as the mean squared error of the node's
prediction, which is equal to the variance of the target values in
the node) under a number of constraints, such as that each node should contain
at least a certain number of observations.
</p>
<p>
As the tree grows, finer and finer partitions of the feature space are created,
reducing the error of the predictions. This process continues until a
pre-specified condition is met, such as that all terminal nodes, referred to as
leaves, contain at least a certain number of observations, or that the depth of
the tree, as determined by the number of nodes or recursive splits
from the root node to the leaves, has reached a certain maximum value.
</p><p>…
Each tree is trained on random subsample
of the training data, and uses a random subset of features to determine the best split at
each node
&lt;a href=”#references”&gt;[3]&lt;/a&gt;
In this post we use the random
forest algorithm for a regression task, in which case the model predictions are obtained
by averaging the predictions of the individual trees.</p>
</section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#data'">¶</a></h2>
<p>
As discussed in <a href="https://fg-research.com/blog/general/posts/fred-md-overview.html" target="_blank">our previous post</a>, the FRED-MD dataset is updated on a monthly basis.
The monthly releases are referred to as <i>vintages</i>. Each vintage includes the data
from January 1959 up to the previous month. For instance, the 02-2024 vintage contains
the data from January 1959 to January 2024.
</p>
<p>
The vintages are subject to retrospective adjustments, such as seasonal adjustments,
inflation adjustments and backfilling of missing values. For this reason, different
vintages can potentially report different values for the same time series on the
same date. Furthermore, different vintages can include different time series, as
indicators are occasionally added and removed from the dataset.
</p>
<p>
We use 02-2023 vintage for training and hyperparameter tuning, while we use the last
month in each vintage from 03-2023 to 02-2024 for testing. Our approach is different
from the one used in <a href="#references">[2]</a>, where the same vintage (01-2016)
is used for both training and testing. In our view, our approach allows us to evaluate
the model in a more realistic scenario where on a given month we forecast next month's
inflation using as input the data available on that month, without taking into account
any ex-post adjustment that could be applied to the data in the future.
</p>
<img alt="Month-over-month logarithmic change in the US CPI index" class="blog-post-image" id="inflation-forecasting-random-forest-time-series" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/time_series_light.png" style="width:80%"/>
<p class="blog-post-image-caption">Month-over-month logarithmic change in the US CPI index (FRED: CPIAUCSL).
Source: FRED-MD dataset, 02-2024 vintage.</p></section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#code'">¶</a></h2>
<p>This section presents and explains the Python code used for the analysis.</p>
<section id="set-up">
<h3>Set-Up<a class="headerlink" href="#set-up" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#set-up'">¶</a></h3>
<p>We start by importing the dependencies.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kn">import</span> <span class="nn">optuna</span>
</span><span id="line-2"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="line-3"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="line-4"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="line-5"><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</span><span id="line-6"><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</span><span id="line-7"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">root_mean_squared_error</span>
</span></code></pre></div>
</div>
<br/>
After that, we define a number of auxiliary functions for downloading and processing the FRED-MD dataset.
As discussed in <a href="https://fg-research.com/blog/general/posts/fred-md-overview.html" target="_blank">
our previous post</a>, the FRED-MD dataset includes a set of transformations to be applied to the time
series in order to ensure their stationarity, which are implemented in the function below.
<br/><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">def</span> <span class="nf">transform_series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tcode</span><span class="p">):</span>
</span><span id="line-2"><span class="w">    </span><span class="sd">'''</span>
</span><span id="line-3"><span class="sd">    Transform the time series.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">    Parameters:</span>
</span><span id="line-6"><span class="sd">    ______________________________________________________________</span>
</span><span id="line-7"><span class="sd">    x: pandas.Series</span>
</span><span id="line-8"><span class="sd">        Time series.</span>
</span><span id="line-9">
</span><span id="line-10"><span class="sd">    tcode: int.</span>
</span><span id="line-11"><span class="sd">        Transformation code.</span>
</span><span id="line-12"><span class="sd">    '''</span>
</span><span id="line-13">
</span><span id="line-14">    <span class="k">if</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="line-15">        <span class="k">return</span> <span class="n">x</span>
</span><span id="line-16">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="line-17">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-18">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="line-19">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-20">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="line-21">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="line-22">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="line-23">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-24">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="line-25">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="line-26">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
</span><span id="line-27">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</span><span id="line-28">    <span class="k">else</span><span class="p">:</span>
</span><span id="line-29">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"unknown `tcode` </span><span class="si">{</span><span class="n">tcode</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<br/>
The function below is used for downloading and processing the training data.
In this function we download the FRED-MD dataset for the considered vintage,
transform the time series using the provided transformation codes (with the
exception of the target time series, for which we use the first order
logarithmic difference as in <a href="#references">[2]</a>) and define the
features as the first lag (i.e. the one-month lag) of the all the time series
(including the target time series). As in <a href="#references">[2]</a>,
we use the data after January 1960, and we use only the time series without
missing values.
<br/><br/>
The function below is used for downloading and processing the test data.
<br/></section>
<section id="hyperparameter-tuning">
<h3>Hyperparameter Tuning<a class="headerlink" href="#hyperparameter-tuning" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#hyperparameter-tuning'">¶</a></h3>
</section>
<section id="model-evaluation">
<h3>Model evaluation<a class="headerlink" href="#model-evaluation" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#model-evaluation'">¶</a></h3>
<img alt="Month-over-month logarithmic change in the US CPI index with random forest (RF) and AR(1) forecasts" class="blog-post-image" id="inflation-forecasting-random-forest-forecasts" src="https://fg-research-blog.s3.eu-west-1.amazonaws.com/inflation-forecasting-random-forest/forecasts_light.png" style="width:80%"/>
<p class="blog-post-image-caption">Month-over-month logarithmic change in the US CPI index (FRED: CPIAUCSL)
with random forest (RF) and AR(1) forecasts.</p></section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#references'">¶</a></h2>
<p>[1] McCracken, M. W., &amp; Ng, S. (2016). FRED-MD: A monthly database for macroeconomic research. <em>Journal of Business &amp; Economic Statistics</em>, 34(4), 574-589. <a class="reference external" href="https://doi.org/10.1080/07350015.2015.1086655">doi: 10.1080/07350015.2015.1086655</a>.</p>
<p>[2] Medeiros, M. C., Vasconcelos, G. F., Veiga, Á., &amp; Zilberman, E. (2021). Forecasting inflation in a data-rich environment: the benefits of machine learning methods. <em>Journal of Business &amp; Economic Statistics</em>, 39(1), 98-119. <a class="reference external" href="https://doi.org/10.1080/07350015.2019.1637745">doi: 10.1080/07350015.2019.1637745</a>.</p>
<p>[3] Breiman, L. (2001). Random forests. <em>Machine learning</em>, 45, 5-32. <a class="reference external" href="https://doi.org/10.1023/A:1010933404324">doi: 10.1023/A:101093340432</a>.</p>
</section>
</section>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(var(--vh)-4rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#model'" class="reference internal" href="#model">Model</a></li>
<li><a :data-current="activeSection === '#data'" class="reference internal" href="#data">Data</a></li>
<li><a :data-current="activeSection === '#code'" class="reference internal" href="#code">Code</a><ul>
<li><a :data-current="activeSection === '#set-up'" class="reference internal" href="#set-up">Set-Up</a></li>
<li><a :data-current="activeSection === '#hyperparameter-tuning'" class="reference internal" href="#hyperparameter-tuning">Hyperparameter Tuning</a></li>
<li><a :data-current="activeSection === '#model-evaluation'" class="reference internal" href="#model-evaluation">Model evaluation</a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#references'" class="reference internal" href="#references">References</a></li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© 
2023 fg-research. fg-research is an independent software vendor that provides machine learning solutions on the AWS Marketplace.
Amazon Web Services, AWS, Amazon SageMaker, AWS Marketplace and the AWS Marketplace logo are trademarks of Amazon.com, Inc. or its affiliates.
 Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 6.2.1</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>